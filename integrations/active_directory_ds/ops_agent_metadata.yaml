platforms:
- type: GCE
  launch_stage: HIDDEN
  launch_date: '2022-05-09'
  agent_requirement:
    logs_minimum_supported_version:
      major: '2'
      minor: '15'
      patch: '0'
    metrics_minimum_supported_version:
      major: '2'
      minor: '15'
      patch: '0'
  detections:
    characteristic_log:
      log_name_regex: AD DS
    characteristic_metric:
      metric_type: workload.googleapis.com/active_directory.ds.bind.rate
  default_logs:
  - name: active_directory_ds
    fields:
    - name: jsonPayload.Message
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The log message.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.RecordNumber
      type: number
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The sequence number of the event log.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.TimeGenerated
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - A timestamp representing when the record was generated.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.TimeWritten
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - A timestamp representing when the record was written to the event log.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.EventID
      type: number
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - An ID identifying the type of the event.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.EventType
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The type of event.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.Qualifiers
      type: number
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - A qualifier number that is used for event identification.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.EventCategory
      type: number
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The category of the event.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.Channel
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The event log channel where the log was logged.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.Sid
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The security identifier identifying a security principal or security group
          of the process that logged this message.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.SourceName
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The source component that logged this message.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.ComputerName
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The name of the computer from which this log originates.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.Data
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - Extra event-specific data included with the log.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.StringInserts
      type: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - '[]string'
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - Dynamic string data that was used to construct the log message.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
  - name: active_directory_ds
    fields:
    - name: jsonPayload.Message
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The log message.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.RecordNumber
      type: number
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The sequence number of the event log.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.TimeGenerated
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - A timestamp representing when the record was generated.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.TimeWritten
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - A timestamp representing when the record was written to the event log.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.EventID
      type: number
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - An ID identifying the type of the event.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.EventType
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The type of event.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.Qualifiers
      type: number
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - A qualifier number that is used for event identification.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.EventCategory
      type: number
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The category of the event.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.Channel
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The event log channel where the log was logged.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.Sid
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The security identifier identifying a security principal or security group
          of the process that logged this message.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.SourceName
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The source component that logged this message.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.ComputerName
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - The name of the computer from which this log originates.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.Data
      type: string
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - Extra event-specific data included with the log.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
    - name: jsonPayload.StringInserts
      type: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - '[]string'
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
      description: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString
        args:
        - Dynamic string data that was used to construct the log message.
        state: !!python/tuple
        - null
        - _yaml_anchor: !!python/object/new:ruamel.yaml.anchor.Anchor
            state: !!python/tuple
            - null
            - value: null
              always_dump: false
  default_metrics:
  - name: workload.googleapis.com/active_directory.ds.bind.rate
    value_type: DOUBLE
    kind: GAUGE
    labels:
    - type
  - name: workload.googleapis.com/active_directory.ds.ldap.bind.last_successful.time
    value_type: INT64
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.ldap.bind.rate
    value_type: DOUBLE
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.ldap.client.session.count
    value_type: INT64
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.ldap.search.rate
    value_type: DOUBLE
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.name_cache.hit_rate
    value_type: DOUBLE
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.notification.queued
    value_type: INT64
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.operation.rate
    value_type: DOUBLE
    kind: GAUGE
    labels:
    - type
  - name: workload.googleapis.com/active_directory.ds.replication.network.io
    value_type: INT64
    kind: CUMULATIVE
    labels:
    - direction
    - type
  - name: workload.googleapis.com/active_directory.ds.replication.object.rate
    value_type: DOUBLE
    kind: GAUGE
    labels:
    - direction
  - name: workload.googleapis.com/active_directory.ds.replication.operation.pending
    value_type: INT64
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.replication.property.rate
    value_type: DOUBLE
    kind: GAUGE
    labels:
    - direction
  - name: workload.googleapis.com/active_directory.ds.replication.sync.object.pending
    value_type: INT64
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.replication.sync.request.count
    value_type: INT64
    kind: CUMULATIVE
    labels:
    - result
  - name: workload.googleapis.com/active_directory.ds.replication.value.rate
    value_type: DOUBLE
    kind: GAUGE
    labels:
    - direction
    - type
  - name: workload.googleapis.com/active_directory.ds.security_descriptor_propagations_event.queued
    value_type: INT64
    kind: GAUGE
    labels: []
  - name: workload.googleapis.com/active_directory.ds.suboperation.rate
    value_type: DOUBLE
    kind: GAUGE
    labels:
    - type
  - name: workload.googleapis.com/active_directory.ds.thread.count
    value_type: INT64
    kind: GAUGE
    labels: []
