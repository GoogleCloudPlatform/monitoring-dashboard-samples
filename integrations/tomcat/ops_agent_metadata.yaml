!!omap
- platforms:
  - !!omap
    - type: GCE
    - launch_stage: GA
    - install_documentation_url: "https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent/third-party/tomcat"
    - agent_requirement: !!omap
      - logs_minimum_supported_version: !!omap
        - major: '2'
        - minor: '9'
        - patch: '0'
      - metrics_minimum_supported_version: !!omap
        - major: '2'
        - minor: '9'
        - patch: '0'
    - detections: !!omap
      - characteristic_log:
          log_name_regex: Tomcat
      - characteristic_metric:
          metric_type: workload.googleapis.com/tomcat.threads
    - default_logs:
      - !!omap
        - name: tomcat_system
        - fields:
          - !!omap
            - name: jsonPayload.message
            - type: string
            - description: Log message, including detailed stacktrace where provided
          - !!omap
            - name: jsonPayload.module
            - type: string
            - description: Module of tomcat where the log originated
          - !!omap
            - name: jsonPayload.source
            - type: string
            - description: source of where the log originated
      - !!omap
        - name: tomcat_access
        - fields:
          - !!omap
            - name: httpRequest.remoteIp
            - type: string
            - description: ''
          - !!omap
            - name: httpRequest.requestUrl
            - type: string
            - description: ''
          - !!omap
            - name: httpRequest.protocol
            - type: string
            - description: ''
          - !!omap
            - name: httpRequest.requestMethod
            - type: string
            - description: ''
          - !!omap
            - name: jsonPayload.host
            - type: string
            - description: Contents of the Host header
          - !!omap
            - name: jsonPayload.user
            - type: string
            - description: Authenticated username for the request
    - default_metrics:
      - !!omap
        - name: workload.googleapis.com/tomcat.errors
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - proto_handler
      - !!omap
        - name: workload.googleapis.com/tomcat.max_time
        - value_type: INT64
        - kind: GAUGE
        - labels:
          - proto_handler
      - !!omap
        - name: workload.googleapis.com/tomcat.processing_time
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - proto_handler
      - !!omap
        - name: workload.googleapis.com/tomcat.request_count
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - proto_handler
      - !!omap
        - name: workload.googleapis.com/tomcat.sessions
        - value_type: DOUBLE
        - kind: GAUGE
        - labels: []
      - !!omap
        - name: workload.googleapis.com/tomcat.threads
        - value_type: INT64
        - kind: GAUGE
        - labels:
          - proto_handler
          - state
      - !!omap
        - name: workload.googleapis.com/tomcat.traffic
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - direction
          - proto_handler
