!!omap
- type: GCE
- launch_stage: GA
- install_documentation_url: "https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent/third-party/iis"
- agent_requirement: !!omap
  - logs_minimum_supported_version: !!omap
    - major: '2'
    - minor: '10'
    - patch: '0'
  - metrics_minimum_supported_version: !!omap
    - major: '2'
    - minor: '10'
    - patch: '0'
- detections: !!omap
  - characteristic_log:
      log_name_regex: IIS
  - characteristic_metric:
      metric_type: agent.googleapis.com/iis/request_count
- default_logs:
  - !!omap
    - name: iis_access
    - fields:
      - !!omap
        - name: httpRequest.serverIp
        - type: string
        - description: "The server's IP and port that was requested"
      - !!omap
        - name: httpRequest.remoteIp
        - type: string
        - description: "IP of the client that made the request"
      - !!omap
        - name: httpRequest.requestUrl
        - type: string
        - description: "Request URL (typically just the path part of the URL)"
      - !!omap
        - name: httpRequest.requestMethod
        - type: string
        - description: "HTTP method"
      - !!omap
        - name: httpRequest.status
        - type: number
        - description: "HTTP status code"
      - !!omap
        - name: httpRequest.userAgent
        - type: string
        - description: "Contents of the `User-Agent` header"
      - !!omap
        - name: httpRequest.referer
        - type: string
        - description: "Contents of the `Referer` header"
      - !!omap
        - name: jsonPayload.sc_substatus
        - type: string
        - description: "The server's IP and port that was requested"
      - !!omap
        - name: jsonPayload.sc_win32_status
        - type: string
        - description: "The server's IP and port that was requested"
      - !!omap
        - name: jsonPayload.time_taken
        - type: string
        - description: "The length of time that the action took, in milliseconds"
      - !!omap
        - name: jsonPayload.user
        - type: string
        - description: "Authenticated username for the request"
- default_metrics:
  - !!omap
    - name: agent.googleapis.com/iis/current_connections
    - value_type: DOUBLE
    - kind: GAUGE
    - labels: []
  - !!omap
    - name: agent.googleapis.com/iis/network/transferred_bytes_count
    - value_type: INT64
    - kind: CUMULATIVE
    - labels:
      - direction
  - !!omap
    - name: agent.googleapis.com/iis/new_connection_count
    - value_type: INT64
    - kind: CUMULATIVE
    - labels: []
  - !!omap
    - name: agent.googleapis.com/iis/request_count
    - value_type: INT64
    - kind: CUMULATIVE
    - labels:
      - http_method
