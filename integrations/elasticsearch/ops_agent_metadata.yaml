!!omap
- platforms:
  - !!omap
    - type: GCE
    - launch_stage: GA
    - install_documentation_url: "https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent/third-party/elasticsearch"
    - agent_requirement: !!omap
      - logs_minimum_supported_version: !!omap
        - major: '2'
        - minor: '9'
        - patch: '0'
      - metrics_minimum_supported_version: !!omap
        - major: '2'
        - minor: '10'
        - patch: '0'
    - detections: !!omap
      - characteristic_log:
          log_name_regex: Elasticsearch
      - characteristic_metric:
          metric_type: workload.googleapis.com/elasticsearch.node.open_files
    - default_logs:
      - !!omap
        - name: elasticsearch_json
        - fields:
          - !!omap
            - name: jsonPayload.message
            - type: string
            - description: 'Log message'
          - !!omap
            - name: jsonPayload.component
            - type: string
            - description: 'The component of Elasticsearch that emitted the log'
          - !!omap
            - name: jsonPayload.type
            - type: string
            - description: 'The type of log, indicating which log the record came from (e.g. *server* indicates this LogEntry came from the server log)'
          - !!omap
            - name: jsonPayload.cluster.name
            - type: string
            - description: 'The name of the cluster emitting the log record'
          - !!omap
            - name: jsonPayload.cluster.uuid
            - type: string
            - description: 'The uuid of the cluster emitting the log record'
          - !!omap
            - name: jsonPayload.node.name
            - type: string
            - description: 'The name of the node emitting the log record'
          - !!omap
            - name: jsonPayload.node.uuid
            - type: string
            - description: 'The uuid of the node emitting the log record'
      - !!omap
        - name: elasticsearch_gc
        - fields:
          - !!omap
            - name: jsonPayload.message
            - type: string
            - description: 'Log message'
          - !!omap
            - name: jsonPayload.type
            - type: string
            - description: 'The type of the log record'
          - !!omap
            - name: jsonPayload.gc_run
            - type: number
            - description: 'The run of the garbage collector'
    - default_metrics:
      - !!omap
        - name: workload.googleapis.com/elasticsearch.cluster.data_nodes
        - value_type: INT64
        - kind: GAUGE
        - labels: []
      - !!omap
        - name: workload.googleapis.com/elasticsearch.cluster.health
        - value_type: INT64
        - kind: GAUGE
        - labels:
          - status
      - !!omap
        - name: workload.googleapis.com/elasticsearch.cluster.nodes
        - value_type: INT64
        - kind: GAUGE
        - labels: []
      - !!omap
        - name: workload.googleapis.com/elasticsearch.cluster.shards
        - value_type: INT64
        - kind: GAUGE
        - labels:
          - state
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.cache.evictions
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - cache_name
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.cache.memory.usage
        - value_type: INT64
        - kind: GAUGE
        - labels:
          - cache_name
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.cluster.connections
        - value_type: INT64
        - kind: GAUGE
        - labels: []
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.cluster.io
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - direction
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.documents
        - value_type: INT64
        - kind: GAUGE
        - labels:
          - state
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.fs.disk.available
        - value_type: INT64
        - kind: GAUGE
        - labels: []
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.http.connections
        - value_type: INT64
        - kind: GAUGE
        - labels: []
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.open_files
        - value_type: INT64
        - kind: GAUGE
        - labels: []
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.operations.completed
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - operation
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.operations.time
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - operation
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.shards.size
        - value_type: INT64
        - kind: GAUGE
        - labels: []
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.thread_pool.tasks.finished
        - value_type: INT64
        - kind: CUMULATIVE
        - labels:
          - state
          - thread_pool_name
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.thread_pool.tasks.queued
        - value_type: INT64
        - kind: GAUGE
        - labels:
          - thread_pool_name
      - !!omap
        - name: workload.googleapis.com/elasticsearch.node.thread_pool.threads
        - value_type: INT64
        - kind: GAUGE
        - labels:
          - state
          - thread_pool_name
